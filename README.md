# Prismagram Backend using Prisma 2

Instragram clone Backend with GraphQL, graphql-yoga and Prisma 2
Migrated the "Prismagram" project(https://github.com/nomadcoders/prismagram) of http://nomadcoders.co to use Prisma 2.


## Settings of DB env

* `prisma/.env` has the URL information.
* If you need to change db provider to another like "postgres" or "mysql",
you need to change the `datasource` section of `prisma/schema.prisma` file.

## Something to know

* Prisma v1 CLI: `npm i -g prisma` or `brew install prisma` to install the CLI and `prisma` to use.
* Prisma v2 CLI: `npm i @prisma/cli --save-dev` to install and `npx prisma` to use.

* `npx prisma introspect` creates/update prisma schema and generate prisma client.
* `npx prisma migrate` creates/update DB schema from the prisma schema. (Experimental)
* https://www.prisma.io/docs/reference/tools-and-interfaces/prisma-schema/data-model#introspection-vs-prisma-migrate


* Prisma 2 doesn't support the Subscription for now. https://github.com/prisma/prisma/issues/298
  So, I use the PubSub of graphql-yoga to implement the newMessage subscription.
  Something confusing while I implement the subscription is that the context of subscription doesn't have the `request` object.
  I think that's because of using websocket (not HTTP) for implementing subscription feature.

* Prisma 2 doesn't generate a CUID for `@id` directive by default.
  We can use `@default(cuid())` instead which is generated by prisma client while it was done by Prisma server when we use Prisma v1.
  We should run `prisma generate` again to update the prisma client to generate the CUID for the `id` field.
